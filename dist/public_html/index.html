<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.4, maximum-scale=0.4, user-scalable=no"/>
    <title>Continuous Tilting Example</title>

    <style>

      body { background: white; }

      .gallery_class {
        -webkit-box-shadow: 0px 0px 0px 2px rgba(0,0,0,0.75);
        -moz-box-shadow: 0px 0px 0px 2px rgba(0,0,0,0.75);
        box-shadow: 0px 0px 0px 2px rgba(0,0,0,0.75);
        margin-top: 10px;
        margin-left: 10px;
        max-width: 200px;
        height: 200px;
      }

      .wrp {
        height:auto;
        display:inline;
      }

      .notselected {
        -webkit-box-shadow: 0px 0px 0px 3px rgba(0,0,0,0.75);
        -moz-box-shadow: 0px 0px 0px 3px rgba(0,0,0,0.75);
        box-shadow: 0px 0px 0px 3px rgba(0,0,0,0.75);
      }

      .selected {
        -webkit-box-shadow: 0px 0px 0px 3px red;
        -moz-box-shadow: 0px 0px 0px 3px red;
        box-shadow: 0px 0px 0px 3px red;
      }

      #touch {
        position: absolute;
        width: 100%;
        height:60%;
      }

      .centerimg {
        top: 10px;
        position: relative;
        left: 10%;
        width: 80%;
      }

      #info {
        position:absolute;
        bottom:0%;
        right: 10%;
      }

    </style>

    <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/jquery-tiltandtap.js"></script>
  </head>
  <body>
    <div class="thumbs-block" id="thumbs-block">
      <div class="wrp">
        <img id="img1" class="gallery_class selected" src="img/img1.jpg"/>
      </div>
      <div class="wrp">
        <img id="img2" class="gallery_class notselected" src="img/img2.jpg"/>
      </div>
      <div class="wrp">
        <img id="img3" class="gallery_class notselected" src="img/img3.jpg"/>
      </div>
      <div class="wrp">
        <img id="img4" class="gallery_class notselected" src="img/img4.jpg"/>
      </div>
    </div>
    <div id="touch">
      <!-- USE THIS DIV AS THE TARGET FOR THE TAP HOLD INTERACTION -->
      <div>
        <p id="info"></p>
      </div>
    </div>
    <script>
      // default variables
      var map = {
        "img1": 1,
        "img2": 2,
        "img3": 3,
        "img4": 4
      }

      var map_info = {
        "img1": "ETH Terrasse",
        "img2": "ETH Main Building, interior",
        "img3": "ETH Main Building",
        "img4": "ETH Main Building 2"
      }

      // tilt and tap
      $( "#touch" ).tiltandtap( {
        tiltLeft: {
          onTiltLeft: select_prev_img
        },
        tiltRight: {
          onTiltRight: select_next_img
        },
        tiltUp: {
          onTiltUp: show_center_img,
          interaction: {
            type: "press",
            element: "touch"
          }
        },
        tiltDown: {
          onTiltDown: hide_center_img,
          interaction: {
            type: "press",
            element: "touch"
          }
        },
        onTiltUp: startTiltUpDown,
        onTiltDown: checkTiltUpDown
      } );

      function get_current_img() {
        return $( ".selected" );
      }

      function get_prev_img( current_img ) {
        return current_img.parent().prev().children( "img" );
      }

      function get_next_img( current_img ) {
        return current_img.parent().next().children( "img" );
      }

      function select_prev_img() {
        var current_img = get_current_img();
        current_img.toggleClass( "selected notselected" );

        var prev_img = get_prev_img( current_img );

        if ( prev_img.length ) {
          prev_img.toggleClass( "selected notselected" );
        } else {
          $( ".wrp:last img" ).toggleClass( "selected notselected" );
        }

        change_center_img();
        change_info();
      }

      function select_next_img() {
        var current_img = get_current_img();
        current_img.toggleClass( "selected notselected" );

        var next_img = get_next_img( current_img );

        if ( next_img.length ) {
          next_img.toggleClass( "selected notselected" );
        } else {
          $( ".wrp:first img" ).toggleClass( "selected notselected" );
        }

        change_center_img();
        change_info();
      }

      function show_center_img() {
        if( !$( ".centerimg" ).length ) {
          get_current_img().clone().prependTo( "#touch" ).toggleClass( "gallery_class selected centerimg" );
        }
      }

      function hide_center_img() {
        $( ".centerimg" ).remove();
      }

      function change_center_img() {
        if ( $( ".centerimg" ).length ) {
          hide_center_img();
          show_center_img();
        }
      }

      // on tilt up down
      var tilt_interval = 2500;
      var tilt_start;

      function startTiltUpDown() {
        tilt_start = new Date().getTime();
      }

      function checkTiltUpDown() {
        tilt_end = new Date().getTime();

        if ( tilt_end - tilt_start <= tilt_interval ) {
          toggle_info();
        }
      }

      function show_info() {
        $( "#info:empty" ).text( map_info[ get_current_img().attr( "id" ) ] );
      }

      function hide_info() {
        $( "#info" ).empty();
      }

      function toggle_info() {
        if ( $( "#info:empty" ).length ) {
          show_info();
        } else {
          hide_info();
        }
      }

      function change_info() {
        if ( !$( "#info:empty" ).length ) {
          hide_info();
          show_info();
        }
      }

    </script>
  </body>
</html>
